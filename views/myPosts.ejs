<% include header.ejs %>
<% include nav.ejs %>
<div class="ui container">
    <h1>My Posts</h1>
    <div class="ui masonry grid">
        <% for(var i = 0; i < posts.length; i++){ %>
        <div class="column">
            <div class="ui fluid card">
                <div class="image">
                    <image src="<%= posts[i].image %>">
                </div>
                <div class="content">
                    <p><%= posts[i].comment %></p>
                </div>
                <div class="extra content">
                    <a class="ui button basic red"><%= posts[i].likedUsers.length %> Likes</a>
                    <a class="ui button red delete" id="<%= posts[i]._id %>">Delete</a>
                </div>
            </div>
        </div>
        <% } %>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function(){
        $('.delete').click(function(){
            if(confirm("Delete Post?")){
                $.ajax({
                    url: '/myPosts',
                    type: 'DELETE',
                    headers: {
                        "post": $(this).attr("id")
                    },
                    success: function(){
                        location.reload();
                    }
                });
            }
            location.reload();
        });
    })
</script>